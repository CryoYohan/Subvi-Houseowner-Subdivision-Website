@{
    Layout = "_HomeLayout";
    ViewData["Title"] = "Subvi | Facilities";

    // Retrieve the user's role from cookies
    string role = Context.Request.Cookies["UserRole"];

    // Declare controller
    string homeController = "";
    string calendarController = "";
    string facilitiesController = "";
    string billController = "";
    string servicesController = "";
    string forumsController = "";
    string feedbacksController = "";
    string resourcesController = "";

    // Default action values
    string homeAction = "";
    string calendarAction = "";
    string facilitiesAction = "";
    string billAction = "";
    string servicesAction = "";
    string forumsAction = "";
    string feedbacksAction = "";
    string resourcesAction = "";

    if (role == "Homeowner")
    {
        homeController = "home"; homeAction = "dashboard";
        calendarController = "home"; calendarAction = "calendar";
        facilitiesController = "home"; facilitiesAction = "facilities";
        billController = "home"; billAction = "bill";
        servicesController = "home"; servicesAction = "services";
        forumsController = "home"; forumsAction = "forums";
        feedbacksController = "home"; feedbacksAction = "feedbacks";
        resourcesController = "home"; resourcesAction = "resources";
    }
}

@section Scripts {
    <script src="~/js/facilities.js"></script>
}

<div class="flex flex-row overflow-hidden pt-4 flex-shrink-0">
    @* Sidebar *@
    <div class="bg-white rounded-tr-2xl z-50 rounded-br-2xl shadow-md w-56 py-6 h-screen">
        <ul class="space-y-4">
            <!-- Home (Dynamic) -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@homeController" asp-action="@homeAction">
                    <i class="fas fa-home text-xl"></i>
                    <span class="font-semibold">Home</span>
                </a>
            </li>

            <!-- Calendar -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@calendarController" asp-action="@calendarAction">
                    <i class="fas fa-calendar-alt text-xl"></i>
                    <span class="font-semibold">Calendar</span>
                </a>
            </li>

            <!-- Facilities -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item active-item"
                   asp-controller="@facilitiesController" asp-action="@facilitiesAction">
                    <i class="fas fa-building text-xl"></i>
                    <span class="font-semibold">Facilities</span>
                </a>
            </li>

            <!-- Bill Payment -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@billController" asp-action="@billAction">
                    <i class="fas fa-file-invoice-dollar text-xl"></i>
                    <span class="font-semibold">Bill Payment</span>
                </a>
            </li>

            <!-- Services -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@servicesController" asp-action="@servicesAction">
                    <i class="fas fa-tools text-xl"></i>
                    <span class="font-semibold">Services</span>
                </a>
            </li>

            <!-- Forums -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@forumsController" asp-action="@forumsAction">
                    <i class="fas fa-comments text-xl"></i>
                    <span class="font-semibold">Forums Discussion</span>
                </a>
            </li>

            <!-- Feedbacks -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@feedbacksController" asp-action="@feedbacksAction">
                    <i class="fas fa-bullhorn text-xl"></i>
                    <span class="font-semibold">Feedbacks</span>
                </a>
            </li>

            <!-- Resources -->
            <li>
                <a class="flex items-center space-x-4 p-3 rounded-l-full sidebar-item hover:bg-gray-100 transition ease-in-out"
                   asp-controller="@resourcesController" asp-action="@resourcesAction">
                    <i class="fas fa-folder text-xl"></i>
                    <span class="font-semibold">Resources</span>
                </a>
            </li>
        </ul>
    </div>

    <style>

        .facility-card:hover img {
            transform: scale(1.05);
            transition: transform 0.3s ease-in-out;
        }

        .facility-card {
            overflow: hidden;
            transition: box-shadow 0.3s ease-in-out;
        }

            .facility-card:hover {
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
    </style>

    @* Main Content *@
    <div id="main-container" class="col-span-12 w-full justify-center">
        <div id="header" class="flex items-center mx-auto space-x-2 mb-4 w-[95%] bg-white text-[#1E3A8A] p-4 rounded-xl shadow-md">
            <i class="fas fa-building text-xl"></i>
            <h1 class="text-2xl font-bold">Our Facilities</h1>
        </div>

        <!-- Main content grid with 70-30 split -->
        <div class="grid grid-cols-12 gap-4 mx-4">
            <!-- Left side - Facilities List -->
            <div class="col-span-8 bg-white p-4 rounded-xl shadow-md">
                <h2 class="text-xl items-center font-bold mb-4 text-[#1E3A8A]">List of Facilities</h2>

                <!-- Facilities Grid -->
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <!-- Swimming Pool Card -->
                    <div class="bg-white p-4 rounded-xl shadow-md facility-card">
                        <img src="~/images/swimmingpool.jpg" alt="Swimming Pool" class="w-full h-48 object-cover rounded-lg mb-4">
                        <h3 class="text-lg font-semibold text-[#1E3A8A] mb-2">Swimming Pool</h3>
                        <p class="text-gray-600 mb-4">A refreshing pool for leisure and fitness with comfortable lounge chairs and shaded areas.</p>
                        <div class="flex space-x-3">
                            <button class="px-6 py-2 bg-white text-[#1E3A8A] border border-[#1E3A8A] rounded-lg hover:bg-gray-50"
                                    data-facility="Swimming Pool">
                                View
                            </button>
                        </div>
                    </div>

                    <!-- Playground Card -->
                    <div class="bg-white p-4 rounded-xl shadow-md facility-card">
                        <img src="~/images/playground.jpg" alt="Playground" class="w-full h-48 object-cover rounded-lg mb-4">
                        <h3 class="text-lg font-semibold text-[#1E3A8A] mb-2">Playground & Park</h3>
                        <p class="text-gray-600 mb-4">A vibrant and safe area for children with swings, slides, and climbing structures.</p>
                        <div class="flex space-x-3">
                            <button class="px-6 py-2 bg-white text-[#1E3A8A] border border-[#1E3A8A] rounded-lg hover:bg-gray-50"
                                    data-facility="Playground">
                                View
                            </button>

                        </div>
                    </div>

                    <!-- Basketball Court Card -->
                    <div class="bg-white p-4 rounded-xl shadow-md facility-card">
                        <img src="~/images/court.jpg" alt="Basketball Court" class="w-full h-48 object-cover rounded-lg mb-4">
                        <h3 class="text-lg font-semibold text-[#1E3A8A] mb-2">Basketball Court</h3>
                        <p class="text-gray-600 mb-4">A professional-grade court for games and practice with spectator seating.</p>
                        <div class="flex space-x-3">
                            <button class="px-6 py-2 bg-white text-[#1E3A8A] border border-[#1E3A8A] rounded-lg hover:bg-gray-50"
                                    data-facility="Basketball Court">
                                View
                            </button>

                        </div>
                    </div>

                    <!-- Fitness Gym Card -->
                    <div class="bg-white p-4 rounded-xl shadow-md facility-card">
                        <img src="~/images/gym.jpg" alt="Fitness Gym" class="w-full h-48 object-cover rounded-lg mb-4">
                        <h3 class="text-lg font-semibold text-[#1E3A8A] mb-2">Fitness Gym</h3>
                        <p class="text-gray-600 mb-4">Modern exercise machines and free weights for comprehensive workouts.</p>
                        <div class="flex space-x-3">
                            <button class="px-6 py-2 bg-white text-[#1E3A8A] border border-[#1E3A8A] rounded-lg hover:bg-gray-50"
                                    data-facility="Fitness Gym">
                                View
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right side - Facility Status -->
            <div class="col-span-4 space-y-4">
                <!-- Requested Facilities -->
                <div class="bg-white p-4 rounded-xl shadow-md">
                    <h2 class="text-xl font-bold mb-4 text-[#1E3A8A]">Requested Facilities</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="text-sm text-gray-500">
                                    <th class="text-left py-2">Facility</th>
                                    <th class="text-left py-2">Date Requested</th>
                                    <th class="text-left py-2">Status</th>
                                    <th class="text-left py-2">Staff Assigned</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr>
                                    <td class="py-2">Swimming Pool</td>
                                    <td class="py-2">10-12-24</td>
                                    <td class="py-2"><span class="px-2 py-1 bg-yellow-100 text-yellow-600 rounded-full">Pending</span></td>
                                    <td class="py-2 text-blue-500">N/A</td>
                                </tr>
                                <!-- Add more rows as needed -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Reservation History -->
                <div class="bg-white p-4 rounded-xl shadow-md">
                    <h2 class="text-xl font-bold mb-4 text-[#1E3A8A]">Reservation History</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="text-sm text-gray-500">
                                    <th class="text-left py-2">Facility</th>
                                    <th class="text-left py-2">Date Completed</th>
                                    <th class="text-left py-2">Status</th>
                                    <th class="text-left py-2">Staff Assigned</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr>
                                    <td class="py-2">--</td>
                                    <td class="py-2">--</td>
                                    <td class="py-2"><span class="px-2 py-1 bg-gray-100 text-gray-600 rounded-full">--</span></td>
                                    <td class="py-2 text-blue-500">--</td>
                                </tr>
                                <!-- Add more rows as needed -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="facilityModal" class="hidden fixed inset-0 z-[9999] overflow-y-auto">
        <div class="fixed inset-0 bg-black/50 transition-opacity duration-300 opacity-0" id="modalOverlay"></div>
        <div class="flex items-center justify-center min-h-screen">
            <div class="modal-content transform transition-all duration-300 scale-95 opacity-0 rounded-xl shadow-xl mx-4 max-w-md w-full" style="background-color: whitesmoke;">
                <img id="modalImage" alt="Facility Image" class="w-full h-64 object-cover rounded-t-xl">
                <div class="p-6">
                    <h3 id="modalTitle" class="text-2xl font-bold text-[#1E3A8A] mb-2"></h3>
                    <p id="modalDescription" class="text-gray-600 mb-4"></p>

                    <div class="mb-4">
                        <h4 class="font-semibold text-[#1E3A8A] mb-2">Assigned Staff</h4>
                        <ul id="modalStaff" class="list-disc list-inside"></ul>
                    </div>

                    <button onclick="confirmReservation(document.getElementById('modalTitle').textContent)"
                            class="w-full bg-[#60A5FA] hover:bg-blue-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200">
                        Reserve Facility
                    </button>
                    <button data-modal-close class="w-full mt-2 text-gray-500 hover:text-gray-700">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="reservationModal" tabindex="-1" aria-labelledby="reservationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" style="max-width: 900px;">
            <div class="modal-content" style="height: 100%; border-radius: 30px;">
                <!-- Modal Header with Close Button -->
                <div class="modal-header p-0 border-0 position-absolute top-0 end-0 z-1">
                    <button type="button" class="btn-close m-3 bg-white rounded-circle p-2 border border-2" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <!-- Modal Body -->
                <div class="modal-body p-0" style="height: 100%;">
                    <div class="flex" style="height: 100%;">
                        <!-- Left Side: Description and Reserve Button (40% width) -->
                        <div class="w3-fourty p-5" style="background-color: #f8f9fa; height: 100%; width: 40%; border-radius: 30px;">
                            <h5 class="modal-title" style="font-size: 30px; color: darkblue;"><b>Reservation Page</b></h5>
                            <p class="text-gray-700 mt-3">
                                Reserve your spot at Subvi’s swimming pool for a refreshing and relaxing experience. Simply choose your preferred time, fill out the reservation form, and submit the small reservation fee to secure your spot. Our team will confirm your booking, and you’ll be ready to enjoy a day of fun and relaxation at the pool. Book today and dive in!
                            </p>

                            <!-- Reserve Facility Button -->
                            <div class="mt-5">
                                <button type="button" class="btn btn-primary px-5 py-2" style="height: 50px; width: 300px;">Reserve Facility</button>
                            </div>
                        </div>

                        <!-- Right Side: Calendar for Schedule Date & Time (60% width) -->
                        <div class="w3-sixty p-5" style="height: 100%; overflow-y: auto; width: 60%;">
                            <h6 class="font-semibold text-lg" style="color: darkblue;">Select a Date & Time</h6>
                            <!-- Calendar -->
                            <div class="mt-4">
                                <div class="flex justify-between items-center mb-4">
                                    <button type="button" class="btn btn-outline-secondary" id="prevMonth">&lt;</button>
                                    <h6 class="font-semibold text-lg" id="currentMonthYear">April 2024</h6>
                                    <button type="button" class="btn btn-outline-secondary" id="nextMonth">&gt;</button>
                                </div>
                                <table class="w-full text-center" id="calendarTable">
                                    <thead>
                                        <tr>
                                            <th>MON</th>
                                            <th>TUE</th>
                                            <th>WED</th>
                                            <th>THU</th>
                                            <th>FRI</th>
                                            <th>SAT</th>
                                            <th>SUN</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Calendar dates will be dynamically populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>